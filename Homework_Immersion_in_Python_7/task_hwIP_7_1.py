"""Напишите функцию группового переименования файлов. Она должна:
    1. принимать параметр желаемое конечное имя файлов. При переименовании в конце имени добавляется порядковый номер.
    2. принимать параметр количество цифр в порядковом номере.
    3. принимать параметр расширение исходного файла.
        Переименование должно работать только для этих файлов внутри каталога.
    4. принимать параметр расширение конечного файла.
    5. принимать диапазон сохраняемого оригинального имени.
        Например, для диапазона [3, 6] берутся буквы с 3 по 6 из исходного имени файла.
        К ним прибавляется желаемое конечное имя, если оно передано. Далее счётчик файлов и расширение."""

import glob
import os
from typing import Tuple


def rename_files(target_name: str, num_digits: int, src_ext: str, dst_ext: str, name_range: Tuple[int, int],
                 directory: str = ".") -> None:
    # Получаем список всех файлов с заданным исходным расширением в указанной директории
    files = glob.glob(f"{directory}/*.{src_ext}")

    # Итерируем по каждому файлу в списке
    for idx, file_path in enumerate(files, start=1):
        # Извлекаем имя файла без пути и расширения
        base_name = os.path.basename(file_path)

        # Извлекаем нужный фрагмент из оригинального имени файла
        original_part = base_name[name_range[0]:name_range[1]]

        # Формируем новое имя файла с целевым именем, порядковым номером и новым расширением
        new_name = f"{original_part}{target_name}{str(idx).zfill(num_digits)}.{dst_ext}"

        # Формируем полный путь к новому файлу
        new_file_path = os.path.join(directory, new_name)

        # Переименовываем файл
        os.rename(file_path, new_file_path)


# Пример использования функции:
# Предположим, у нас есть файлы "test_001.txt", "test_002.txt", ..., и мы хотим добавить к их имени "новое_имя",
# изменить расширение на "docx" и сохранить первые 4 символа оригинального имени.
# Номера в новых именах должны быть трехзначными.
rename_files("новое_имя", 3, "txt", "docx", (0, 4), "E:/files_to_rename")
